(function(){var e=function(e){return document.querySelector(e)};var t=e("#text");var r=e("#result");var n=e("#issue-list");var i=e("#issue-count");var a=e("#url-prefix");var s=["#16a085","#27ae60","#2980b9","#8e44ad","#2c3e50","#d35400","#c0392b","#bdc3c7","#7f8c8d"];var u=function(e){var r=this;r.issues=[];r.issueCount=0;r.urlPrefix="";r.setOptions();t.addEventListener("keyup",r.startJIRAThing.bind(this));t.addEventListener("keydown",r.startJIRAThing.bind(this));a.addEventListener("keyup",r.updateOptions.bind(this));document.addEventListener("keydown",function(e){if(e&&((e.ctrlKey||e.metaKey)&&e.keyCode==13)){e.preventDefault();if(confirm("This will open a lot of windows")==true)r.openThemAll()}})};u.prototype={startJIRAThing:function(e){this.issues=l(t.value);this.issues=this.issues.filter(function(e,t,r){return r.indexOf(e)===t});this.updateIssueData();if(this.issues.length<1){return}},openThemAll:function(){if(!this.urlPrefix){return}var e=this.issues;for(var t=0;t<e.length;t++){var r=e[t];window.open(this.urlPrefix+"/"+r)}},updateIssueData:function(){this.updateIssueCount();this.updateIssueList()},updateIssueCount:function(e){i.innerHTML=this.issues.length},updateIssueList:function(){var e=0;var i=s[e];var a=this.issues;n.innerHTML="";var u=new Object;r.innerHTML=t.value;for(var o=0;o<a.length;o++){var l=document.createElement("li");if(this.urlPrefix){var c=a[o];var f=document.createElement("a");var d=this.urlPrefix+"/"+c;l.style.backgroundColor=i;var h=a[o+1];if(h){var p=c.split("-")[0];var v=h.split("-")[0];if(p!=v){l.className="spacer";i=s[e+1];e=(e+1)%(s.length-1)}}f.href=d;f.target="blank";f.appendChild(document.createTextNode(a[o]));l.appendChild(f);u[c]='<a href="'+d+'" target="blank">'+c+"</a>"}else{l.appendChild(document.createTextNode(a[o]))}n.appendChild(l)}var g=Object.keys(u);if(g.length>0){var x=new RegExp("\\b"+g.join("\\b|\\b"),"gi");r.innerHTML=r.innerHTML.replace(x,function(e){return u[e]}).replace(/\r\n|\r|\n/g,"<br />")}},updateOptions:function(){var e=a.value;localStorage.urlPrefix=e;this.urlPrefix=e;f("urlPrefix",e)},setOptions:function(){var e=c("urlPrefix")||localStorage.urlPrefix||"";this.urlPrefix=e;a.value=e;f("urlPrefix",e)}};function o(e){return e.split("").reverse().join("")}function l(e){var t=/\d+-[A-Z]+(?!-?[a-zA-Z]{1,10})/g;var r=o(e).match(t);var n=[];if(!r||r.length<1){return n}for(var i=0;i<r.length;i++){n[i]=o(r[i])}return n.reverse().sort()}function c(e,t){if(!t)t=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=r.exec(t);if(!n)return null;if(!n[2])return"";return decodeURIComponent(n[2].replace(/\+/g," "))}function f(e,t){var r=[location.protocol,"//",location.host,location.pathname].join(""),n=document.location.search,i=e+"="+t,a="?"+i;if(n){keyRegex=new RegExp("([?&])"+e+"[^&]*");if(n.match(keyRegex)!==null){a=n.replace(keyRegex,"$1"+i)}else{a=n+"&"+i}}window.history.replaceState({},"",r+a)}var d=new u})();